import{U as p,Y as u,gd as f,s as c}from"./chunk-NVYEZAQB.js";var v=(()=>{class s{tflService=u(f);static startsWithSortFn=(t,i,e)=>t.lineName.startsWith(e)&&i.lineName.startsWith(e)||!t.lineName.startsWith(e)&&!i.lineName.startsWith(e)?0:t.lineName.startsWith(e)?-1:1;mapRouteSearchResponseToDto(t){let i=[];return t.searchMatches.forEach(e=>{let a=e.lineId,d=e.lineName;e.lineRouteSection.forEach(r=>{var n={id:`${a}-${r.direction}`,lineId:a,lineName:d,direction:r.direction,destination:r.vehicleDestinationText};i.map(m=>m.id).indexOf(n.id)<0&&i.push(n)})}),i}find(t){return this.tflService.findBusRoutes(t).pipe(c(this.mapRouteSearchResponseToDto),c(i=>i.sort((e,a)=>s.startsWithSortFn(e,a,t))))}mapRouteDetailsResponseToDto(t){let i=[];t.orderedLineRoutes.length!==0&&t.stopPointSequences.length!==0&&t.orderedLineRoutes[0].naptanIds.forEach(n=>{let o=t.stopPointSequences[0].stopPoint.find(l=>l.id===n);o&&i.push(o)});let e=i.map(n=>({id:n.id,commonName:n.name,stopLetter:n.stopLetter,lines:n.lines.filter(o=>o.id!==t.lineId).map(o=>({id:o.id,name:o.name})),latitude:n.lat,longitude:n.lon})),a=e?e[0].commonName:"",d=e?e[e.length-1].commonName:"";return{lineId:t.lineId,lineName:t.lineName,direction:t.direction,isOutboundOnly:t.isOutboundOnly,from:a,to:d,stops:e,path:JSON.parse(t.lineStrings[0])[0]}}details(t,i){return this.tflService.routeSequence(t,i).pipe(c(this.mapRouteDetailsResponseToDto))}static \u0275fac=function(i){return new(i||s)};static \u0275prov=p({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();export{v as a};
